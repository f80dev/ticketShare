<!--Panel de commande-->
<div *ngIf="message?.length==0" style="width: 100%;">
  <button mat-button mat-icon-button class="app-button" (click)="router.navigate(['home'])">
    <mat-icon>arrow_back_ios</mat-icon>
  </button>
  <button mat-button mat-flat-button
          *ngIf="total>0"
          style="background-color: darkred;color:white;"
          class="app-button" (click)="buy()">
    &nbsp;&nbsp;Acheter &nbsp;&nbsp;
  </button>
  &nbsp;
  <span *ngIf="nb_places>0">
    {{nb_places}} places
  </span>

  <span *ngIf="total>0">pour un total de {{total}}€, soit {{total/etherprice |number:'1.1-5'}} ether</span>
</div>

<app-hourglass [message]="message"></app-hourglass>

<div *ngIf="tickets?.length>0 && message?.length==0" style="margin:10px;">
  <h3>Billets placées</h3>
  <mat-selection-list #select>
    <mat-list-option *ngFor="let ticket of tickets"
                     [value]="ticket._id"
                     (click)="update_total(select?.selectedOptions?.selected)">
        <mat-icon matListIcon>event_seat</mat-icon>
        <h3 matLine>Place {{ticket.seat}}</h3>
        <p matLine>{{ticket.description}}</p>
        <p matLine>
          <span>{{ticket.price}}</span>€
          <mat-icon style="cursor: pointer;display: inline-block;" ngxClipboard [cbContent]="ticket.address">copy</mat-icon>
        </p>
    </mat-list-option>
  </mat-selection-list>
</div>


<div *ngIf="l_categories.length>0 && message.length==0" style="margin: 10px;">
  <h3>Billets nons placés</h3>
  <table style="width: 100%;" cellpadding="5">
  <tr *ngFor="let cat of l_categories">
    <td *ngIf="categories[cat].to_buy>0" style="width: 150px;">
      <img [src]="categories[cat].visual" style="margin:5px;width: 100%;height: 75px;object-fit: cover;">
    </td>
    <td *ngIf="categories[cat].to_buy>0" style="width: 200px;">
      {{categories[cat].description}}<br>
      <small>{{categories[cat].to_buy-categories[cat].buy}} places disponibles<br></small><br>
      <small>Prix {{cat}}€</small>
    </td>
    <td *ngIf="categories[cat].to_buy>0" style="text-align:left;width:30%;">
      <mat-slider
        style="width:100%;"
        thumbLabel
        (valueChange)="update_total(select?.selectedOptions?.selected)"
        tickInterval="1"
        [(ngModel)]="categories[cat].buy"
        min="0"
        max="{{categories[cat].to_buy}}">
      </mat-slider>
    </td>
    <td *ngIf="categories[cat].to_buy>0" style="text-align:left;">
      <span style="font-size: xx-large">{{categories[cat].buy}}</span>
      &nbsp;<small>places</small>
    </td>
  </tr>
  </table>
</div>

