<app-hourglass [message]="message"></app-hourglass>
<div style="width:100%;text-align: center;" *ngIf="showScanner && message.length==0">
  <h2>Validation des entrées de {{_event?.name}}</h2>


  <app-scanner [size]="300"
               *ngIf="config.webcamsAvailable>0"
               (flash)="onflash_event($event)">
  </app-scanner>

  <mat-form-field class="form-field-style" style="width: 70%;max-width: 300px;">
    <input type="text" matInput
           id="txtAddress"
           title="Saisissez l'adresse de votre compte Ethereum"
           placeholder="Adresse du wallet du visiteur"
           [(ngModel)]="address"
           (change)="update_addr($event)">
  </mat-form-field>
  <br>

  <button class="app-button" mat-button mat-raised-button
          *ngIf="address!=null && address.startsWith('0x')"
          (click)="update_addr(address)">
    Recherche des places
  </button>

  <div  *ngIf="config.webcamsAvailable==0" style="font-size: x-small">
    <br><br>
    Aucune caméra détectée sur ce device<br>pour valider les entrées sur la base du QRCode<br>
  </div>

  <br><br>

  <div *ngIf="_event.owner==config.user.address">
    <div *ngIf="_event.validate.checkers?.length>1">
      Liste des valideurs:
      <div *ngFor="let val of _event.validate.checkers">
        <span *ngIf="val!=config.user.address">{{val}}</span>
      </div>
      <br>
    </div>
    <button class="app-button" mat-button mat-raised-button
            (click)="add_checker()">
      Ajouter un valideur
    </button>
  </div>


</div>



<div style="width:100%;text-align: center;margin-top:10%;" *ngIf="tickets.length>0 && message.length==0">

  <h2>Propriétaire des billets</h2>
  {{_user.pseudo}}<br>
  <img [src]="_user?.photo"
        class="image-photo"
        width="150px" height="150px">
  <br>

  <h2>{{tickets.length}} entrée(s) valable(s)</h2>

  <button class="app-button"
          mat-button mat-raised-button
          (click)="burn(true)">
    Tout utiliser
  </button>

  <mat-selection-list #select>
    <mat-list-option *ngFor="let ticket of tickets"
                     [value]="ticket._id"
                     (click)="update_toburn(select?.selectedOptions?.selected)">
      <mat-icon matListIcon>event_seat</mat-icon>
      <h3 matLine>#{{ticket.seat || ticket.ref}}</h3>
      <h3 matLine>Pour le {{ticket.date*1000 | date:'dd/MM/yy HH:mm'}}</h3>
    </mat-list-option>
  </mat-selection-list>

  <div *ngIf="to_burn.length>0">
    <br>
    <button class="app-button" mat-button
            mat-raised-button (click)="burn(false)">
      Utiliser {{to_burn.length}} places
    </button>
  </div>

</div>

