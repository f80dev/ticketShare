<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Minimal store sample</title>
    <script src="js/main.js"></script>
</head>
<body onload="run()">
<table style="width:100vw;">
  <tr>
    <th>Exemple minimaliste de boutique</th>
    <th>Proc√©dure</th>
  </tr>
  <tr>
    <td style="width: 300px;text-align: left;">
      <form id="frm">
        <div>
          <label for="email">Email</label>
          <input name="email" id="email" value="paul.dudule@gmail.com">
        </div>
        <br>
        <div>
          <label for="tickets">Combien de billets</label>
          <input name="tickets" type="number" size="3" id="tickets" value="2" max="10" min="0">
        </div>
        <br>
        <div>
          <label for="price">Prix</label>
          <input name="price" type="number" id="price" value="30" max="300" min="0">
        </div>
        <br>
        <div>
          <label for="date">Date</label>
          <input name="date" type="date" id="date" value="2021-01-01">
        </div>

        <div>
          <br>
        </div>
      </form>

      <button onclick="send()">Commander</button>
    </td>
    <td>
      <iframe id="faq" src="https://app.kerberus.tech/faqs.html?faq=extern_store"
              style="border:none;overflow:hidden;min-height:500px;width:100%;background: none;"></iframe>
    </td>
  </tr>
</table>
</body>

<script>
  function run(){
    if(!getParam().hasOwnProperty("faq") || screen.availWidth<500)
      document.getElementById("faq").style.display="none";
  }

  function send(){

    var idevent=getParam().idevent;
    if(idevent==null)idevent=0;

    var domain=getParam().domain;
    if(domain==null)domain="http://localhost:6800";

    var url=domain+"/api/add_ticket/"+idevent;
    url=url.replace("http//","http://").replace("https//","https://");
    fetch(url,
      {
        body: new FormData(document.getElementById('frm')),
        method: "post"
      }).then(function (r) {
        r.json().then(function (resp) {
        location.href=resp.data.redirect;
      });
    },function(r) {
      console.log(r);
    });
  }
</script>

</html>
